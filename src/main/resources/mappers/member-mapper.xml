<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="Member">
	  <resultMap id="memberRM" type="Member">
		<id property="id" column="id" />
		<result property="pw" column="pw" />
		<result property="uname" column="uname" />
		<result property="nickname" column="nickname" />
		<result property="intro" column="intro" />
		<result property="gender" column="gender" />
		<result property="email" column="email" />
		<result property="phone" column="phone" />
		<result property="address" column="address" />
		<result property="join_date" column="join_date" />
		<result property="kind" column="kind" />
	</resultMap>
	<!-- 로그인 -->
	<select id="memberLogin" resultType="Member">
	 select * from member where id = #{id} and pw = #{pw}
	</select>

	<!-- 회원가입 -->
	<insert id="memberJoin">
		insert into
		member(id,pw,uname,nickname,intro,gender,email,phone,address,join_date,kind)
		values(#{id},#{pw}, #{uname}, #{nickname},#{intro}, #{gender}, #{email}, #{phone}, #{address}, SYSDATE, 'U')
	</insert>
	
	<!-- 아이디 중복검사 -->
  	<select id="idCheck" resultType="int">
  		select count(*) from member where id = #{id}
  	</select>
  	
  	<!-- 이메일 중복검사 -->
  	<select id="emailCheck" resultType="int">
  		select count(*) from member where email = #{email}
  	</select>
  	
  	<!-- 닉네임 중복검사 -->
  	<select id="nicknameCheck" resultType="int">
  		select count(*) from member where nickname = #{nickname} 	
  	</select>
  	
  	<!-- 비밀번호 변경 -->
	<update id="pwChange" parameterType="Member">
		update member set pw=#{pw} where id = #{id}
	</update> 

 	<!-- 회원정보 수정 -->
	<update id="memberUpdate" parameterType="Member">
		update member set uname = #{uname}, nickname = #{nickname},intro = #{intro}, gender = #{gender}, phone = #{phone}, address = #{address}
		 where id = #{id}
	</update>
	
  	<!-- 회원 탈퇴 -->
	<delete id="memberDelete" >
		delete from member where id = #{id} and pw = #{pw}
	</delete>
	
	<select id="memberList" resultType="Member">
		select * from member where id = #{id }
	</select>
	
	<!-- 비밀번호 찾기 회원정보 조회 -->
	<select id="pwSelectMember" resultType="Member">
		select * from member where uname = #{uname} and id = #{id} and email = #{email} 
	</select>

	<!-- 비밀번호 찾기 비밀번호 변경 -->
	<update id = "pwFindUpdate" parameterType="Member">
		update member set pw=#{pw} where email = #{email} 
	</update>
	
	<!-- 회원 프로필사진 수정 -->
	<update id="memberProfileUpdate" parameterType="Member">
		update member set member_img= #{member_img} where id = #{id}
	</update>

	<!-- 프로필 사진 가져오기 -->
	<select id="getMemberProfile" resultMap="memberRM" parameterType="Member">
		select member_img from member where id = #{id}
	</select>
	
	<select id="getmember" resultMap="memberRM"
		parameterType="Member">
		select * from member
		where id like '%' || #{id} || '%' or uname like  '%' || #{id} || '%' or nickname like  '%' || #{id} || '%'
	</select>
	<!-- 회원 프로필사진 삭제 -->
	<update id="memberProfileDelete" parameterType="Member">
		update member set member_img=null where id = #{id}
	</update>
</mapper>
